<!DOCTYPE html>
<html lang="ar" dir="rtl" data-theme="light"><head><script>(function(firebaseConfig, initialAuthToken, appId) {
        window.__firebase_config = firebaseConfig;
        window.__initial_auth_token = initialAuthToken;
        window.__app_id = appId;
            })("\n{\n  \"apiKey\": \"AIzaSyCqyCcs2R2e7AegGjvFAwG98wlamtbHvZY\",\n  \"authDomain\": \"bard-frontend.firebaseapp.com\",\n  \"projectId\": \"bard-frontend\",\n  \"storageBucket\": \"bard-frontend.firebasestorage.app\",\n  \"messagingSenderId\": \"175205271074\",\n  \"appId\": \"1:175205271074:web:2b7bd4d34d33bf38e6ec7b\"\n}\n","eyJhbGciOiJSUzI1NiIsImtpZCI6IjdiNWFlNDg4ZGU5NDlkNmY0OGJhYzU1ZmMwYTE1NzJlZTJmNjExMzciLCJ0eXAiOiJKV1QifQ.eyJzdWIiOiJmaXJlYmFzZS1hZG1pbnNkay1mYnN2Y0BiYXJkLWZyb250ZW5kLmlhbS5nc2VydmljZWFjY291bnQuY29tIiwiYXVkIjoiaHR0cHM6Ly9pZGVudGl0eXRvb2xraXQuZ29vZ2xlYXBpcy5jb20vZ29vZ2xlLmlkZW50aXR5LmlkZW50aXR5dG9vbGtpdC52MS5JZGVudGl0eVRvb2xraXQiLCJ1aWQiOiIwNzA5MjQyNzU0MTU0NTY0NjY4MCIsImlzcyI6ImZpcmViYXNlLWFkbWluc2RrLWZic3ZjQGJhcmQtZnJvbnRlbmQuaWFtLmdzZXJ2aWNlYWNjb3VudC5jb20iLCJjbGFpbXMiOnsiYXBwSWQiOiJjX2JjMTE5NTgyNmI1ZTRmMjVf2KfZhNmB2LXZhF_Yp9mE2KvYp9mE2Ktf2YjYp9mE2LnYtNix2YjZhl_Yp9mE2KzYr9mI2YTYqV_ZiNin2YTYrdis2LIuaHRtbC0xMTkifSwiZXhwIjoxNzcxNjY5MjY0LCJpYXQiOjE3NzE2NjU2NjQsImFsZyI6IlJTMjU2In0.fcHGVQZw9hI-xnFRQbyVhVWGcLPL2nhUDmGW2EXRnDNT9AjcVZolFg2RcsHvJHW-2gGQ-nAsBNxe2a1uOzyExPpyeo5PLBzM439WjZLq-SJzTRi6FgT8WgWFj6VOd06WNPn2wDhdKiqUeseH1ZzXHd4nt3vfOG8vJso7IwNOd9GOeLYwfYF033q1catf7Cmp3K_X78nKwiX5algoRMTAu3ImOnKvAMk-T1vBH8vy0P2np2tQyMkLYhG0oPfllhwzUJfJhaOwsBgIFDE3aH0NXl90f9UfN9v9Ai2ipbMlNBDZgBjXNXFPPSUnLZW4jFJZ3khslYP-XJEtsHF81a4Tog","c_bc1195826b5e4f25_الفصل_الثالث_والعشرون_الجدولة_والحجز.html-119")</script><script>(function(){'use strict';var h=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,b,d){if(a==Array.prototype||a==Object.prototype)return a;a[b]=d.value;return a};function l(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<a.length;++b){var d=a[b];if(d&&d.Math==Math)return d}throw Error("Cannot find global object");}var n=l(this);
function p(a,b){if(b)a:{var d=n;a=a.split(".");for(var c=0;c<a.length-1;c++){var e=a[c];if(!(e in d))break a;d=d[e]}a=a[a.length-1];c=d[a];b=b(c);b!=c&&b!=null&&h(d,a,{configurable:!0,writable:!0,value:b})}}function r(a){function b(c){return a.next(c)}function d(c){return a.throw(c)}return new Promise(function(c,e){function f(g){g.done?c(g.value):Promise.resolve(g.value).then(b,d).then(f,e)}f(a.next())})}function t(a){return r(a())}
p("Object.values",function(a){return a?a:function(b){var d=[],c;for(c in b)Object.prototype.hasOwnProperty.call(b,c)&&d.push(b[c]);return d}});p("Array.prototype.includes",function(a){return a?a:function(b,d){var c=this;c instanceof String&&(c=String(c));var e=c.length;d=d||0;for(d<0&&(d=Math.max(d+e,0));d<e;d++){var f=c[d];if(f===b||Object.is(f,b))return!0}return!1}});/*

 MIT License

 Copyright (c) 2017-2023 W.Y.

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice and this permission notice shall be included in
 all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 SOFTWARE.

*/
function u(a,b){const d=a.style;b.backgroundColor&&(d.backgroundColor=b.backgroundColor);b.width&&(d.width=`${b.width}px`);b.height&&(d.height=`${b.height}px`);const c=b.style;c!=null&&Object.keys(c).forEach(e=>{d[e]=c[e]})};var v=(()=>{let a=0;return()=>{a+=1;return`u${`0000${(Math.random()*1679616<<0).toString(36)}`.slice(-4)}${a}`}})();function w(a){const b=[];for(let d=0,c=a.length;d<c;d++)b.push(a[d]);return b}let x=null;function y(a={}){return x?x:a.l?x=a.l:x=w(window.getComputedStyle(document.documentElement))}function z(a,b){return(a=(a.ownerDocument.defaultView||window).getComputedStyle(a).getPropertyValue(b))?parseFloat(a.replace("px","")):0}
function A(a,b={}){var d;if(!(d=b.width)){d=z(a,"border-left-width");var c=z(a,"border-right-width");d=a.clientWidth+d+c}(b=b.height)||(b=z(a,"border-top-width"),c=z(a,"border-bottom-width"),b=a.clientHeight+b+c);return{width:d,height:b}}function B(a){return new Promise((b,d)=>{const c=new Image;c.onload=()=>{c.decode().then(()=>{requestAnimationFrame(()=>b(c))})};c.onerror=d;c.crossOrigin="anonymous";c.decoding="async";c.src=a})}
function C(a){return t(function*(){return Promise.resolve().then(()=>(new XMLSerializer).serializeToString(a)).then(encodeURIComponent).then(b=>`data:image/svg+xml;charset=utf-8,${b}`)})}
function D(a,b,d){return t(function*(){const c=document.createElementNS("http://www.w3.org/2000/svg","svg"),e=document.createElementNS("http://www.w3.org/2000/svg","foreignObject");c.setAttribute("width",`${b}`);c.setAttribute("height",`${d}`);c.setAttribute("viewBox",`0 0 ${b} ${d}`);e.setAttribute("width","100%");e.setAttribute("height","100%");e.setAttribute("x","0");e.setAttribute("y","0");e.setAttribute("externalResourcesRequired","true");c.appendChild(e);e.appendChild(a);return C(c)})}
var E=(a,b)=>{if(a instanceof b)return!0;a=Object.getPrototypeOf(a);return a===null?!1:a.constructor.name===b.name||E(a,b)};function F(a,b){return y(b).map(d=>{const c=a.getPropertyValue(d),e=a.getPropertyPriority(d);return`${d}: ${c}${e?" !important":""};`}).join(" ")}
function G(a,b,d,c){a=window.getComputedStyle(a,d);var e=a.getPropertyValue("content");if(e!==""&&e!=="none"){var f=v();try{b.className=`${b.className} ${f}`}catch(k){return}e=document.createElement("style");var g=e.appendChild;d=`.${f}:${d}`;a.cssText?(c=a.getPropertyValue("content"),c=`${a.cssText} content: '${c.replace(/'|"/g,"")}';`):c=F(a,c);g.call(e,document.createTextNode(`${d}{${c}}`));b.appendChild(e)}};function H(a){return a.search(/^(data:)/)!==-1}function I(a,b,d){return t(function*(){const c=yield fetch(a,b);if(c.status===404)throw Error(`Resource "${c.url}" not found`);const e=yield c.blob();return new Promise((f,g)=>{const k=new FileReader;k.onerror=g;k.onloadend=()=>{try{f(d({o:c,result:k.result}))}catch(m){g(m)}};k.readAsDataURL(e)})})}const J={};function K(a,b,d){let c=a.replace(/\?.*/,"");d&&(c=a);/ttf|otf|eot|woff2?/i.test(c)&&(c=c.replace(/.*\//,""));return b?`[${b}]${c}`:c}
function L(a,b,d){return t(function*(){const c=K(a,b,d.C);if(J[c]!=null)return J[c];d.u&&(a+=(/\?/.test(a)?"&":"?")+(new Date).getTime());let e;try{const f=yield I(a,d.i,({o:g,result:k})=>{b||(b=g.headers.get("Content-Type")||"");return k.split(/,/)[1]});e=`data:${b};base64,${f}`}catch(f){e=d.B||""}return J[c]=e})};const M={P:"application/font-woff",R:"application/font-woff",N:"application/font-truetype",v:"application/vnd.ms-fontobject",H:"image/png",F:"image/jpeg",D:"image/jpeg",A:"image/gif",M:"image/tiff",L:"image/svg+xml",O:"image/webp"};function N(a){return(a=/\.([^./]*?)$/g.exec(a))?a[1]:""};function O(a){return t(function*(){const b=a.toDataURL();return b==="data:,"?a.cloneNode(!1):B(b)})}function aa(a,b){return t(function*(){if(a.currentSrc){var d=document.createElement("canvas");const c=d.getContext("2d");d.width=a.clientWidth;d.height=a.clientHeight;c==null||c.drawImage(a,0,0,d.width,d.height);d=d.toDataURL();return B(d)}d=a.poster;d=yield L(d,M[N(d).toLowerCase()]||"",b);return B(d)})}
function ba(a,b){return t(function*(){try{let d;if(a==null?0:(d=a.contentDocument)==null?0:d.body)return yield P(a.contentDocument.body,b,!0)}catch(d){}return a.cloneNode(!1)})}function ca(a,b){return t(function*(){return E(a,HTMLCanvasElement)?O(a):E(a,HTMLVideoElement)?aa(a,b):E(a,HTMLIFrameElement)?ba(a,b):a.cloneNode(a.tagName!=null&&a.tagName.toUpperCase()==="SVG")})}
function da(a,b,d){return t(function*(){if(b.tagName!=null&&b.tagName.toUpperCase()==="SVG")return b;let c=[];if(a.tagName!=null&&a.tagName.toUpperCase()==="SLOT"&&a.assignedNodes)c=w(a.assignedNodes());else{let e;if(E(a,HTMLIFrameElement)&&((e=a.contentDocument)==null?0:e.body))c=w(a.contentDocument.body.childNodes);else{let f;c=w(((f=a.shadowRoot)!=null?f:a).childNodes)}}if(c.length===0||E(a,HTMLVideoElement))return b;yield c.reduce((e,f)=>e.then(()=>P(f,d)).then(g=>{g&&b.appendChild(g)}),Promise.resolve());
return b})}function ea(a,b,d){const c=b.style;if(c){var e=window.getComputedStyle(a);e.cssText?(c.cssText=e.cssText,c.transformOrigin=e.transformOrigin):y(d).forEach(f=>{let g=e.getPropertyValue(f);f==="font-size"&&g.endsWith("px")&&(g=`${Math.floor(parseFloat(g.substring(0,g.length-2)))-.1}px`);E(a,HTMLIFrameElement)&&f==="display"&&g==="inline"&&(g="block");f==="d"&&b.getAttribute("d")&&(g=`path(${b.getAttribute("d")})`);c.setProperty(f,g,e.getPropertyPriority(f))})}}
function fa(a,b){E(a,HTMLSelectElement)&&(b=Array.from(b.children).find(d=>a.value===d.getAttribute("value")))&&b.setAttribute("selected","")}
function ha(a,b){return t(function*(){var d=a.querySelectorAll?a.querySelectorAll("use"):[];if(d.length===0)return a;var c={};for(var e=0;e<d.length;e++){var f=d[e].getAttribute("xlink:href");if(f){const g=document.querySelector(f);a.querySelector(f)||!g||c[f]||(c[f]=yield P(g,b,!0))}}d=Object.values(c);if(d.length){c=document.createElementNS("http://www.w3.org/1999/xhtml","svg");c.setAttribute("xmlns","http://www.w3.org/1999/xhtml");c.style.position="absolute";c.style.width="0";c.style.height="0";
c.style.overflow="hidden";c.style.display="none";e=document.createElementNS("http://www.w3.org/1999/xhtml","defs");c.appendChild(e);for(f=0;f<d.length;f++)e.appendChild(d[f]);a.appendChild(c)}return a})}
function P(a,b,d){return t(function*(){return d||!b.filter||b.filter(a)?Promise.resolve(a).then(c=>ca(c,b)).then(c=>da(a,c,b)).then(c=>{E(c,Element)&&(ea(a,c,b),G(a,c,":before",b),G(a,c,":after",b),E(a,HTMLTextAreaElement)&&(c.textContent=a.value),E(a,HTMLInputElement)&&c.setAttribute("value",a.value),fa(a,c));return c}).then(c=>ha(c,b)):null})};const Q=/url\((['"]?)([^'"]+?)\1\)/g,ia=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,ja=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function ka(a){const b=[];a.replace(Q,(d,c,e)=>{b.push(e);return d});return b.filter(d=>!H(d))}
function la(a,b,d,c){return t(function*(){try{const e=d?(new URL(b,d||void 0)).toString():b;let f;f=yield L(e,M[N(b).toLowerCase()]||"",c);return a.replace(new RegExp(`(url\\(['"]?)(${b.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1")})(['"]?\\))`,"g"),`$1${f}$3`)}catch(e){}return a})}function ma(a,{I:b}){return b?a.replace(ja,d=>{for(;;){const [c,,e]=ia.exec(d)||[],f=c,g=e;if(!g)return"";if(g===b)return`src: ${f};`}}):a}
function R(a,b,d){return t(function*(){if(a.search(Q)===-1)return a;const c=ma(a,d);return ka(c).reduce((e,f)=>e.then(g=>la(g,f,b,d)),Promise.resolve(c))})};function S(a,b,d){return t(function*(){var c;const e=(c=b.style)==null?void 0:c.getPropertyValue(a);return e?(c=yield R(e,null,d),b.style.setProperty(a,c,b.style.getPropertyPriority(a)),!0):!1})}function na(a,b){return t(function*(){(yield S("background",a,b))||(yield S("background-image",a,b));(yield S("mask",a,b))||(yield S("-webkit-mask",a,b))||(yield S("mask-image",a,b))||(yield S("-webkit-mask-image",a,b))})}
function oa(a,b){return t(function*(){const d=E(a,HTMLImageElement);if(d&&!H(a.src)||E(a,SVGImageElement)&&!H(a.href.baseVal)){var c=d?a.src:a.href.baseVal,e=yield L(c,M[N(c).toLowerCase()]||"",b);yield new Promise((f,g)=>{a.onload=f;a.onerror=b.m?(...k)=>{try{f(b.m(...k))}catch(m){g(m)}}:g;a.decode&&(a.decode=f);a.loading==="lazy"&&(a.loading="eager");d?(a.srcset="",a.src=e):a.href.baseVal=e})}})}
function pa(a,b){return t(function*(){const d=w(a.childNodes).map(c=>T(c,b));yield Promise.all(d).then(()=>a)})}function T(a,b){return t(function*(){E(a,Element)&&(yield na(a,b),yield oa(a,b),yield pa(a,b))})};const U={};function V(a){return t(function*(){var b=U[a];if(b!=null)return b;b=yield(yield fetch(a)).text();b={url:a,cssText:b};return U[a]=b})}function W(a,b){return t(function*(){let d=a.cssText;const c=/url\(["']?([^"')]+)["']?\)/g,e=(d.match(/url\([^)]+\)/g)||[]).map(f=>t(function*(){let g=f.replace(c,"$1");g.startsWith("https://")||(g=(new URL(g,a.url)).href);return I(g,b.i,({result:k})=>{d=d.replace(f,`url(${k})`);return[f,k]})}));return Promise.all(e).then(()=>d)})}
function X(a){if(a==null)return[];const b=[];a=a.replace(/(\/\*[\s\S]*?\*\/)/gi,"");for(var d=RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");;){var c=d.exec(a);if(c===null)break;b.push(c[0])}a=a.replace(d,"");d=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi;for(c=RegExp("((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})","gi");;){let e=d.exec(a);if(e===null)if(e=c.exec(a),e===null)break;else d.lastIndex=c.lastIndex;else c.lastIndex=
d.lastIndex;b.push(e[0])}return b}
function qa(a,b){return t(function*(){const d=[],c=[];a.forEach(e=>{if("cssRules"in e)try{w(e.cssRules||[]).forEach((f,g)=>{if(f.type===CSSRule.IMPORT_RULE){let k=g+1;f=V(f.href).then(m=>W(m,b)).then(m=>X(m).forEach(q=>{try{e.insertRule(q,q.startsWith("@import")?k+=1:e.cssRules.length)}catch(Da){}})).catch(()=>{});c.push(f)}})}catch(f){const g=a.find(k=>k.href==null)||document.styleSheets[0];e.href!=null&&c.push(V(e.href).then(k=>W(k,b)).then(k=>X(k).forEach(m=>{g.insertRule(m,g.cssRules.length)})).catch(()=>
{}))}});return Promise.all(c).then(()=>{a.forEach(e=>{if("cssRules"in e)try{w(e.cssRules||[]).forEach(f=>{d.push(f)})}catch(f){}});return d})})}function ra(a){return a.filter(b=>b.type===CSSRule.FONT_FACE_RULE).filter(b=>b.style.getPropertyValue("src").search(Q)!==-1)}function sa(a,b){return t(function*(){if(a.ownerDocument==null)throw Error("Provided element is not within a Document");var d=w(a.ownerDocument.styleSheets);d=yield qa(d,b);return ra(d)})}
function ta(a){function b(c){(c.style.fontFamily||getComputedStyle(c).fontFamily).split(",").forEach(e=>{d.add(e.trim().replace(/["']/g,""))});Array.from(c.children).forEach(e=>{e instanceof HTMLElement&&b(e)})}const d=new Set;b(a);return d}function ua(a,b){return t(function*(){const d=yield sa(a,b),c=ta(a);return(yield Promise.all(d.filter(e=>c.has(e.style.fontFamily.trim().replace(/["']/g,""))).map(e=>R(e.cssText,e.parentStyleSheet?e.parentStyleSheet.href:null,b)))).join("\n")})}
function va(a,b){return t(function*(){const d=b.j!=null?b.j:b.K?null:yield ua(a,b);if(d){const c=document.createElement("style");c.appendChild(document.createTextNode(d));a.firstChild?a.insertBefore(c,a.firstChild):a.appendChild(c)}})};function wa(a,b={}){return t(function*(){const {width:d,height:c}=A(a,b),e=yield P(a,b,!0);yield va(e,b);yield T(e,b);u(e,b);return yield D(e,d,c)})}
function xa(a,b={}){return t(function*(){const {width:d,height:c}=A(a,b);var e=yield wa(a,b);e=yield B(e);const f=document.createElement("canvas"),g=f.getContext("2d"),k=b.G||window.devicePixelRatio||1,m=b.h||d,q=b.g||c;f.width=m*k;f.height=q*k;!b.J&&(f.width>16384||f.height>16384)&&(f.width>16384&&f.height>16384?f.width>f.height?(f.height*=16384/f.width,f.width=16384):(f.width*=16384/f.height,f.height=16384):f.width>16384?(f.height*=16384/f.width,f.width=16384):(f.width*=16384/f.height,f.height=
16384));f.style.width=`${m}`;f.style.height=`${q}`;b.backgroundColor&&(g.fillStyle=b.backgroundColor,g.fillRect(0,0,f.width,f.height));g.drawImage(e,0,0,f.width,f.height);return f})}function ya(a,b={}){return t(function*(){return(yield xa(a,b)).toDataURL()})};const za=["gemini.google.com","corp.google.com","proxy.googlers.com"];function Y(){return document.body.querySelectorAll('[class*="animate"]').length>0}function Z(a){return t(function*(){try{return yield ya(a,{h:a.offsetWidth,g:a.offsetHeight})}catch(d){var b=a.offsetHeight;const c=document.createElement("canvas");c.width=a.offsetWidth;c.height=b;return c.toDataURL("image/png")}})}
function Aa(){return t(function*(){const a=document.body.offsetWidth,b=document.body.offsetHeight,d=document.body.cloneNode(!0);d.querySelectorAll('[class*="animate"]').forEach(c=>{c.classList.remove(...Array.from(c.classList).filter(e=>e.startsWith("animate")))});d.style.width=`${a}px`;d.style.height=`${b}px`;return d})}
function Ba(a){return t(function*(){let b=document.body;if(Y()){var d=yield Aa();b=d;document.body.appendChild(d)}d=yield Z(b);Y()&&document.body.removeChild(b);window.parent.postMessage({type:"SEND_SCREENSHOT",image:d,topOffset:document.documentElement.scrollTop},a.origin)})}function Ca(a){return t(function*(){const b={type:"SEND_SCREENSHOT_FOR_DATA_VISUALIZATION",image:yield Z(document.body),topOffset:0};window.parent.postMessage(b,a.origin)})}
window.addEventListener("message",a=>t(function*(){if(za.some(d=>a.origin.includes(d))){var b=a.data;b&&(b.type==="MAKE_SCREENSHOT"&&(yield Ba(a)),b.type==="MAKE_SCREENSHOT_FOR_DATA_VISUALIZATION"&&(yield Ca(a)))}}));
})();</script><script>(function() {
  // Ensure this script is executed only once
  if (window.firebaseAuthBridgeScriptLoaded) {
    return;
  }
  window.firebaseAuthBridgeScriptLoaded = true;

  let nextTokenPromiseId = 0;

  // Stores { resolve, reject } for ongoing token requests
  const pendingTokenPromises = {};

  // Listen for messages from the Host Application
  window.addEventListener('message', function(event) {

    const messageData = event.data;

  if (messageData && messageData.type === 'RESOLVE_NEW_FIREBASE_TOKEN') {
      const { success, token, error, promiseId } = messageData ?? {};
      if (pendingTokenPromises[promiseId]) {
        if (success) {
          pendingTokenPromises[promiseId].resolve(token);
        } else {
          pendingTokenPromises[promiseId].reject(new Error(error || 'Token refresh failed from host.'));
        }
        delete pendingTokenPromises[promiseId];
      }
    }
  });

  // Expose a function for the Generated App to request a new Firebase token
  window.requestNewFirebaseToken = function() {
    const currentPromiseId = nextTokenPromiseId++;
    const promise = new Promise((resolve, reject) => {
      pendingTokenPromises[currentPromiseId] = { resolve, reject };
    });
    if (window.parent && window.parent !== window) {
      window.parent.postMessage({
        type: 'REQUEST_NEW_FIREBASE_TOKEN',
        promiseId: currentPromiseId
      }, '*');
    } else {
      pendingTokenPromises[currentPromiseId].reject(new Error('No parent window to request token from.'));
      delete pendingTokenPromises[currentPromiseId];
    }
    return promise;
  };
})();</script><script>
let realOriginalGetUserMedia = null;
if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
  realOriginalGetUserMedia = navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);
}

(function() {
  if (navigator.mediaDevices && navigator.mediaDevices.__proto__) {
    try {
      Object.defineProperty(navigator.mediaDevices.__proto__, 'getUserMedia', {
        get: function() {
          return undefined; // Or throw an error
        },
        configurable: false
      });
    } catch (error) {
      console.error("Error defining prototype getter:", error);
    }
  }
})();

(function() {
  const pendingMediaResolvers = {};
  let nextMediaPromiseId = 0;

  function requestMediaPermissions(constraints) {
    const mediaPromiseId = nextMediaPromiseId++;
    const promise = new Promise((resolve, reject) => {
      pendingMediaResolvers[mediaPromiseId] = (granted) => {
        delete pendingMediaResolvers[mediaPromiseId];
        resolve(granted);
      };
    });

    window.parent.postMessage({
      type: 'requestMediaPermission',
      constraints: constraints,
      promiseId: mediaPromiseId,
    }, '*');

    return promise;
  }

  let originalGetUserMedia = realOriginalGetUserMedia;

  function interceptGetUserMedia() {
    if (navigator.mediaDevices) {
      Object.defineProperty(navigator.mediaDevices, 'getUserMedia', {
        value: function(constraints) {
          return requestMediaPermissions(constraints).then((granted) => {
            if (granted) {
              if (originalGetUserMedia) {
                return originalGetUserMedia(constraints);
              } else {
                throw new Error("Original getUserMedia not available.");
              }
            } else {
              throw new DOMException('Permission denied', 'NotAllowedError');
            }
          });
        },
        writable: false,
        configurable: false
      });
    }
  }

  interceptGetUserMedia();

  const observer = new MutationObserver(function(mutationsList, observer) {
    for (const mutation of mutationsList) {
      if (mutation.type === 'reconfigured' && mutation.name === 'getUserMedia' && mutation.object === navigator.mediaDevices) {
        interceptGetUserMedia();
      } else if (mutation.type === 'attributes' && mutation.attributeName === 'getUserMedia' && mutation.target === navigator.mediaDevices) {
        interceptGetUserMedia();
      } else if (mutation.type === 'childList' && mutation.addedNodes) {
        mutation.addedNodes.forEach(node => {
          if (node === navigator.mediaDevices) {
            interceptGetUserMedia();
          }
        });
      }
    }
  });

  function interceptSpeechRecognition() {
    if (!window.SpeechRecognition && !window.webkitSpeechRecognition) {
      return;
    }

    const OriginalSpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;

    const SpeechRecognitionWrapper = function(...args) {
      const recognizer = new OriginalSpeechRecognition(...args);
      const originalStart = recognizer.start.bind(recognizer);

      recognizer.start = function() {
        requestMediaPermissions({ audio: true }).then(granted => {
          if (granted) {
            originalStart();
          } else {
            const errorEvent = new SpeechRecognitionErrorEvent('error');
            errorEvent.error = 'not-allowed'; // This is the standard error for permission denial.
            recognizer.dispatchEvent(errorEvent);
          }
        });
      };

      return recognizer;
    };

    SpeechRecognitionWrapper.prototype = OriginalSpeechRecognition.prototype;
    SpeechRecognitionWrapper.prototype.constructor = SpeechRecognitionWrapper;

    if (window.SpeechRecognition) {
      window.SpeechRecognition = SpeechRecognitionWrapper;
    }
    if (window.webkitSpeechRecognition) {
      window.webkitSpeechRecognition = SpeechRecognitionWrapper;
    }
  }

  interceptSpeechRecognition();

  window.addEventListener('message', function(event) {
    if (event.data) {
      if (event.data.type === 'resolveMediaPermission') {
        const { promiseId, granted } = event.data;
        if (pendingMediaResolvers[promiseId]) {
          pendingMediaResolvers[promiseId](granted);
        }
      }
    }
  });

})();</script><script>((function(modelInformation) {
  const originalFetch = window.fetch;
  // TODO: b/421908508 - Move these out of the script and match all generative AI model calls.
  let googleLlmBaseApiUrls = [
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.textModelName + ':streamGenerateContent',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.textModelName + ':generateContent',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.imageModelName + ':predict',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.imageModelName + ':predictLongRunning',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.imageEditModelName + ':generateContent',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.imageTransformModelName + ':generateContent',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.videoModelName + ':predict',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.videoModelName + ':predictLongRunning',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.ttsModelName + ':generateContent',
  ];
  modelInformation.deprecatedTextModelNames.forEach((modelName) => {
    googleLlmBaseApiUrls.push(
      'https://generativelanguage.googleapis.com/v1beta/models/' + modelName + ':streamGenerateContent',
      'https://generativelanguage.googleapis.com/v1beta/models/' + modelName + ':generateContent',
    );
  });
  modelInformation.deprecatedImageModelNames.forEach((modelName) => {
    googleLlmBaseApiUrls.push(
      'https://generativelanguage.googleapis.com/v1beta/models/' + modelName + ':predict',
      'https://generativelanguage.googleapis.com/v1beta/models/' + modelName + ':predictLongRunning',
    );
  });

  const pendingFetchResolvers = {};
  let nextPromiseId = 0;

  function handleStringInput(input, optionsArgument) {
    const actualUrl = input;
    const fetchCallArgs = [actualUrl, optionsArgument];
    const effectiveOptions = optionsArgument || {};
    const bodyForApiKeyCheck = effectiveOptions.body;
    const bodyForPostMessage = effectiveOptions.body;
    return { actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage };
  }

  function handleRequestInput(input, optionsArgument) {
    const actualUrl = input.url;
    const fetchCallArgs = [input, optionsArgument];
    const effectiveOptions = { method: input.method, headers: new Headers(input.headers) };
    let bodyForApiKeyCheck;
    let bodyForPostMessage;

    if (optionsArgument) {
      if (optionsArgument.method) effectiveOptions.method = optionsArgument.method;
      if (optionsArgument.headers) effectiveOptions.headers = new Headers(optionsArgument.headers);
      if ('body' in optionsArgument) {
        bodyForApiKeyCheck = optionsArgument.body;
        bodyForPostMessage = optionsArgument.body;
      } else {
        bodyForApiKeyCheck = undefined;
        bodyForPostMessage = input.body;
      }
    } else {
      bodyForApiKeyCheck = undefined;
      bodyForPostMessage = input.body;
    }
    return { actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage };
  }

  window.fetch = function(input, optionsArgument) {
    let actualUrl;
    let fetchCallArgs;
    let effectiveOptions = {};
    let bodyForApiKeyCheck;
    let bodyForPostMessage;

    if (typeof input === 'string') {
      ({actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage} = handleStringInput(input, optionsArgument));
    } else if (input instanceof Request) {
      ({actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage} = handleRequestInput(input, optionsArgument));
    } else {
      return originalFetch.apply(window, [input, optionsArgument]);
    }

    effectiveOptions.method = effectiveOptions.method || 'GET';
    if (!effectiveOptions.headers) {
      effectiveOptions.headers = new Headers();
    }


    if (typeof actualUrl === 'string' && googleLlmBaseApiUrls.some((url) => actualUrl.startsWith(url))) {
      let apiKeyIsNull = true;

      const regex = new RegExp("models/([^:]+)");
      const modelNameMatch = actualUrl.match(regex);
      const modelName = modelNameMatch ? modelNameMatch[1] : 'unspecified';


      try {
        const urlObject = new URL(actualUrl);  // Use URL object for robust parsing
        const apiKeyParam = urlObject.searchParams.get('key');
        if (apiKeyParam) {
          apiKeyIsNull = false;
        }
      } catch (e) {
        // Continue checks even if URL parsing fails
      }

      if (apiKeyIsNull && effectiveOptions.headers) {
        const h = new Headers(effectiveOptions.headers);
        const apiKeyHeaderValue = h.get('X-API-Key') || h.get('x-api-key');
        if (apiKeyHeaderValue) {
          apiKeyIsNull = false;
          return originalFetch.apply(window, fetchCallArgs);
        }
      }

      if (apiKeyIsNull && effectiveOptions.method && ['POST', 'PUT', 'PATCH'].includes(effectiveOptions.method.toUpperCase()) && typeof bodyForApiKeyCheck === 'string') {
        try {
          const bodyData = JSON.parse(bodyForApiKeyCheck);
          if (bodyData && bodyData.apiKey) {
            apiKeyIsNull = false;
            return originalFetch.apply(window, fetchCallArgs);
          }
        } catch (e) {
          // Ignore JSON parsing errors
        }
      }

      if(apiKeyIsNull) {
        const promiseId = nextPromiseId++;
        const promise = new Promise((resolve) => {
          pendingFetchResolvers[promiseId] = (resolvedResponse) => {
            delete pendingFetchResolvers[promiseId];
            resolve(resolvedResponse);
          };
        });

        let serializedBodyForPostMessage;
        if (typeof bodyForPostMessage === 'string' || bodyForPostMessage == null) {
            serializedBodyForPostMessage = bodyForPostMessage;
        } else if (bodyForPostMessage instanceof ReadableStream) {
            serializedBodyForPostMessage = null;
        } else {
            try {
                serializedBodyForPostMessage = JSON.stringify(bodyForPostMessage);
            } catch (e) {
                serializedBodyForPostMessage = null;
            }
        }

        const messageOptions = {
            method: effectiveOptions.method,
            headers: Object.fromEntries(new Headers(effectiveOptions.headers).entries()),
            body: serializedBodyForPostMessage
        };

        window.parent.postMessage({
          type: 'requestFetch',
          url: actualUrl,
          modelName: modelName,
          options: messageOptions,
          promiseId: promiseId,
        }, '*');

        return promise;
      }
      return originalFetch.apply(window, fetchCallArgs);
    }
    return originalFetch.apply(window, fetchCallArgs);
  };

  window.addEventListener('message', function(event) {
    if (event.data && event.data.type === 'resolveFetch') {
      const { promiseId, response } = event.data;
      if (pendingFetchResolvers[promiseId]) {
        try {
          const reconstructedResponse = new Response(response.body, {
            status: response.status,
            statusText: response.statusText,
            headers: new Headers(response.headers),
          });
          pendingFetchResolvers[promiseId](reconstructedResponse);
        } catch (error) {
          pendingFetchResolvers[promiseId](new Response(null, { status: 500, statusText: "Interceptor Response Reconstruction Error" }));
        }
      }
    }
  });

}))({"textModelName":"gemini-2.5-flash","imageModelName":"imagen-4.0-generate-001","imageEditModelName":"gemini-2.5-flash-image-preview","imageTransformModelName":"gemini-3-pro-image-preview-11-2025","videoModelName":"veo-2.0-generate-001","ttsModelName":"gemini-2.5-flash-preview-tts","deprecatedTextModelNames":["gemini-2.0-flash","gemini-2.5-flash-preview-04-17","gemini-2.5-flash-preview-05-20","gemini-2.5-flash-preview-09-2025"],"deprecatedImageModelNames":["imagen-3.0-generate-001","imagen-3.0-generate-002"]})</script><script>(function(){'use strict';function a(){window.parent.postMessage({type:"interaction"},"*")}window.addEventListener("click",a,{capture:!0,passive:!0});window.addEventListener("touchstart",a,{capture:!0,passive:!0});window.addEventListener("keydown",a,{capture:!0,passive:!0});}).call(this);
</script><script>(function() {
  const originalConsoleLog = console.log;
  const originalConsoleError = console.error;

    /**
   * Normalizes an error event or a promise rejection reason into a structured error object.
   * @param {*} errorEventOrReason The error object or reason.
   * @return {object} Structured error data { message, name, stack }.
   */
  function getErrorObject(errorEventOrReason) {
    if (errorEventOrReason instanceof Error) {
      return {
        message: errorEventOrReason.message,
        name: errorEventOrReason.name,
        stack: errorEventOrReason.stack,
      };
    }
    // Fallback for non-Error objects.
    try {
      return {
        message: JSON.stringify(errorEventOrReason),
        name: 'UnknownErrorType',
        stack: null,
      };
    } catch (e) {
      return {
        message: String(errorEventOrReason),
        name: 'UnknownErrorTypeNonStringifiable',
        stack: null,
      };
    }
  }

  /**
   * Converts an array of arguments (from log/error) into a single string.
   * Handles Error objects specially to include their message and stack.
   * @param {Array<*>} args - Arguments passed to console methods.
   * @return {string} A string representation of the arguments.
   */
  function stringifyArgs(args) {
    return args
      .map((arg) => {
        if (arg instanceof Error) {
          const {message, stack} = arg;
          return `Error: ${message}${stack ? ('\nStack: ' + stack) : ''}`;
        }
        if (typeof arg === 'object' && arg !== null) {
          try {
            return JSON.stringify(arg);
          } catch (error) {
            return '[Circular Object]';
          }
        } else {
          return String(arg);
        }
      })
      .join(' ');
  }

  console.log = function(...args) {
    const logString = stringifyArgs(args);
    window.parent.postMessage({ type: 'log', message: logString }, '*');
    originalConsoleLog.apply(console, args);
  };

  console.error = function(...args) {
    let errorData;
    if (args.length > 0 && args[0] instanceof Error) {
      const err = args[0];
      // If the first arg is an Error, capture its details.
      errorData = {
        type: 'error',
        source: 'CONSOLE_ERROR',
        ...getErrorObject(err),
        rawArgsString: stringifyArgs(args.slice(1)),
        timestamp: new Date().toISOString(),
      };
    } else {
      // If not an Error object, treat all args as a general error message.
      errorData = {
        type: 'error',
        source: 'CONSOLE_ERROR',
        message: stringifyArgs(args),
        name: 'ConsoleLoggedError',
        stack: null,
        timestamp: new Date().toISOString(),
      };
    }
    window.parent.postMessage(errorData, '*');
    originalConsoleError.apply(console, args);
  };

  // Listen for global unhandled synchronous errors.
  window.addEventListener('error', function(event) {
    const errorDetails = event.error ? getErrorObject(event.error) : {
      message: event.message,
      name: 'GlobalError',
      stack: null,
      filename: event.filename,
      lineno: event.lineno,
      colno: event.colno,
    };

    window.parent.postMessage({
      type: 'error',
      source: 'global',
      ...errorDetails,
      message: errorDetails.message || event.message,
      timestamp: new Date().toISOString(),
    }, '*');
  });

  // Listen for unhandled promise rejections (asynchronous errors).
  window.addEventListener('unhandledrejection', function(event) {
    const errorDetails = getErrorObject(event.reason);

    window.parent.postMessage({
      type: 'error',
      source: 'unhandledrejection',
      ...errorDetails,
      message: errorDetails.message || 'Unhandled Promise Rejection',
      timestamp: new Date().toISOString(),
    }, '*');
  });

})();</script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>الفصل الثالث والعشرون — قواعد الجدولة، الحجز، وتخصيص المسرح الجراحي</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
    <link href="https://fonts.googleapis.com/css2?family=Amiri:ital,wght@0,400;0,700;1,400&amp;family=Noto+Kufi+Arabic:wght@300;400;600;800&amp;display=swap" rel="stylesheet">
    <style>
      :root {
        --primary-blue: #2563eb;
        --light-blue-bg: #dbeafe;
        --text-color: #1f2937;
        --box-blue: #eff6ff;
        --box-blue-border: #bfdbfe;
        --box-green: #f0fdf4;
        --box-green-border: #bbf7d0;
        --box-yellow: #fefce8;
        --box-yellow-border: #fef08a;
        --box-red: #fef2f2;
        --box-red-border: #fecaca;
      }

      body {
        font-family: 'Amiri', 'Times New Roman', serif;
        line-height: 1.8;
        color: var(--text-color);
        background-color: #fff;
        max-width: 900px;
        margin: 0 auto;
        padding: 40px 60px;
        box-sizing: border-box;
        text-align: justify;
        font-size: 19px;
      }

      h1 {
        font-family: 'Noto Kufi Arabic', sans-serif;
        font-weight: 800;
        color: #1e3a8a;
        text-align: center;
        font-size: 32px;
        margin-bottom: 10px;
        margin-top: 40px;
        line-height: 1.3;
      }

      .part-title {
        text-align: center;
        font-size: 18px;
        color: #6b7280;
        font-family: 'Noto Kufi Arabic', sans-serif;
        margin-bottom: 5px;
        text-transform: uppercase;
        letter-spacing: 1px;
      }

      h2 {
        font-family: 'Noto Kufi Arabic', sans-serif;
        font-weight: 600;
        color: var(--primary-blue);
        background-color: var(--light-blue-bg);
        padding: 12px 20px;
        margin-top: 50px;
        margin-bottom: 25px;
        border-right: 6px solid #1e40af;
        border-radius: 4px;
        font-size: 24px;
        page-break-after: avoid;
      }

      h3 {
        font-family: 'Noto Kufi Arabic', sans-serif;
        font-weight: 600;
        color: #1e40af;
        font-size: 20px;
        margin-top: 30px;
        margin-bottom: 15px;
        border-bottom: 2px solid #e5e7eb;
        padding-bottom: 5px;
      }

      h4 {
        font-family: 'Noto Kufi Arabic', sans-serif;
        font-weight: 600;
        color: #374151;
        font-size: 19px;
        margin-top: 25px;
        margin-bottom: 10px;
      }

      p {
        margin-bottom: 18px;
      }

      .subtitle {
        text-align: center;
        font-size: 22px;
        color: #4b5563;
        margin-bottom: 40px;
        font-family: 'Noto Kufi Arabic', sans-serif;
        border-bottom: 1px solid #e5e7eb;
        padding-bottom: 20px;
      }

      /* Boxes Style */
      .quote-box {
        background-color: var(--box-blue);
        border: 1px solid var(--box-blue-border);
        border-right: 5px solid var(--primary-blue);
        padding: 20px 25px;
        margin: 25px 0;
        border-radius: 4px;
        color: #1e3a8a;
      }

      .alert-box {
        background-color: var(--box-red);
        border: 1px solid var(--box-red-border);
        border-right: 5px solid #ef4444;
        padding: 20px 25px;
        margin: 25px 0;
        border-radius: 4px;
      }

      .success-box {
        background-color: var(--box-green);
        border: 1px solid var(--box-green-border);
        border-right: 5px solid #22c55e;
        padding: 20px 25px;
        margin: 25px 0;
        border-radius: 4px;
      }

      .concept-box {
        background-color: var(--box-yellow);
        border: 1px solid var(--box-yellow-border);
        border-right: 5px solid #eab308;
        padding: 20px 25px;
        margin: 25px 0;
        border-radius: 4px;
      }

      /* Tables Style */
      table {
        width: 100%;
        border-collapse: collapse;
        margin: 25px 0;
        font-size: 0.95em;
        background-color: #fff;
        border: 1px solid #e5e7eb;
      }
      
      thead tr {
        background-color: var(--primary-blue);
        color: #ffffff;
        text-align: right;
      }
      
      th, td {
        padding: 12px 15px;
        border: 1px solid #e5e7eb;
      }
      
      tbody tr:nth-of-type(even) {
        background-color: #f9fafb;
      }

      /* Lists */
      ul, ol {
        margin-bottom: 20px;
        padding-right: 30px;
      }

      li {
        margin-bottom: 10px;
      }

      strong {
        color: #111827;
        font-weight: bold;
      }

      .divider {
        text-align: center;
        color: #9ca3af;
        margin: 50px 0;
        font-size: 24px;
        letter-spacing: 5px;
      }

      .english-term {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        font-weight: 600;
        color: var(--primary-blue);
        direction: ltr;
        display: inline-block;
      }

      /* References */
      .references-list {
        font-size: 16px;
        color: #4b5563;
        direction: ltr;
        text-align: left;
        margin-top: 30px;
        border-top: 1px solid #e5e7eb;
        padding-top: 20px;
      }

      .references-list li {
        margin-bottom: 8px;
      }

      @media (max-width: 768px) {
        body { padding: 20px; font-size: 17px; }
        table { display: block; overflow-x: auto; }
      }

      /* Download Button Style */
      .download-btn {
        position: fixed;
        bottom: 30px;
        left: 30px;
        background-color: #2563eb;
        color: white;
        padding: 15px 25px;
        border: none;
        border-radius: 50px;
        font-family: 'Noto Kufi Arabic', sans-serif;
        font-weight: bold;
        font-size: 16px;
        cursor: pointer;
        box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        z-index: 1000;
        display: flex;
        align-items: center;
        gap: 10px;
        transition: background-color 0.3s, transform 0.2s;
      }

      .download-btn:hover {
        background-color: #1d4ed8;
        transform: translateY(-2px);
      }
    </style>
</head>
<body style="padding-top: 40px;">

    <!-- Download Button -->
    

    <div class="part-title">PART V — OR Operations, Flow, and Efficiency Without Safety Trade-offs</div>
    <div class="part-title">الجزء الخامس — عمليات غرفة العمليات، التدفق، والكفاءة دون المساومة على السلامة</div>
    
    <h1>CHAPTER 23 — Scheduling, Booking, and Theatre Allocation Rules</h1>
    <div class="subtitle">الفصل الثالث والعشرون — قواعد الجدولة، الحجز، وتخصيص المسرح الجراحي<br>
    <span style="font-size: 18px;">(Booking Discipline • Priority Rules • Add-on Cases • Capacity Alignment)<br>
    (انضباط الحجز • قواعد الأولوية • الحالات الإضافية • مواءمة السعة)</span></div>
    
    <h2>أهداف الفصل / Chapter Aims</h2>
    <div class="concept-box">
        <p>بحلول نهاية هذا الفصل، ستكون قادراً على:</p>
        <p><span class="english-term">By the end of this chapter, you will be able to:</span></p>
        <ol>
            <li>شرح لماذا لا تُعد الجدولة "عملاً إدارياً" بل <strong>نظام سلامة سريري (Clinical safety system)</strong> يُشكل الإرهاق، والعمل المتسرع، والإلغاءات، وخطر "الأحداث التي لا ينبغي أن تحدث" (Never-events). (IHI; AHRQ; WHO SSC concepts)<br>
            <span class="english-term">Explain why scheduling is not “administration” but a <strong>clinical safety system</strong> that shapes fatigue, rushed work, cancellations, and never-event risk. (IHI; AHRQ; WHO SSC concepts)</span></li>
            
            <li>تصميم <strong>انضباط حجز (Booking discipline)</strong> يمنع الفشل المتوقع: تقديرات المدة الخاطئة، المتطلبات المسبقة المفقودة، الجاهزية غير المكتملة للغرسات، والأطقم المعارة المتأخرة التي تجبر الفريق على اختصارات غير آمنة. (IHI; AORN concepts)<br>
            <span class="english-term">Design <strong>booking discipline</strong> that prevents predictable failure: wrong duration estimates, missing prerequisites, incomplete implant readiness, and late loaners that force unsafe shortcuts. (IHI; AORN concepts)</span></li>
            
            <li>تطبيق <strong>قواعد أولوية (Priority rules)</strong> شفافة للعمل المجدول (Elective)، والعاجل (Urgent)، والطارئ (Emergency) تحمي العدالة <em>والسلامة</em> معاً، خاصة تحت عبء العمل الزائد. (AHRQ; IHI)<br>
            <span class="english-term">Apply transparent <strong>priority rules</strong> for elective, urgent, and emergency work that protect fairness <em>and</em> safety, especially under overload. (AHRQ; IHI)</span></li>
            
            <li>إدارة <strong>الحالات الإضافية (Add-on cases)</strong> دون تدمير حواجز السلامة: بوابات الجاهزية، التوقفات الإلزامية، ومسارات التصعيد الواضحة. (IHI; AHRQ)<br>
            <span class="english-term">Manage <strong>add-on cases</strong> without destroying safety barriers: readiness gates, hard stops, and clear escalation pathways. (IHI; AHRQ)</span></li>
            
            <li>مواءمة <strong>السعة (Capacity)</strong> (الموظفين، CSSD، الأسرة، PACU، التخدير، المعدات) مع الطلب بحيث لا تُصبح "الكفاءة" اسماً حركياً لـ "الخطر". (IHI; AHRQ)<br>
            <span class="english-term">Align <strong>capacity</strong> (staffing, CSSD, beds, PACU, anesthesia, equipment) with demand so “efficiency” does not become code for “risk.” (IHI; AHRQ)</span></li>
        </ol>
    </div>

    <h2>السيناريو الافتتاحي / Opening Scenario</h2>
    <div class="quote-box">
        <strong>حالة واقعية: "الحالة الإضافية التي وصلت كالعاصفة"</strong><br>
        <span class="english-term">A true-to-life case: “The add-on that arrived like a storm” (Real Scientific Story)</span>
    </div>

    <p>في العديد من المستشفيات، لا يفشل يوم غرفة العمليات لأن الجراحين غير مبالين. بل يفشل لأن الجدول الزمني غير صادق.</p>
    <p><span class="english-term">In many hospitals, the OR day does not fail because surgeons are careless. It fails because the schedule is dishonest.</span></p>

    <p>تمت إضافة حالة في منتصف النهار—"يُفترض أن تكون سريعة". كانت مذكرة الحجز ضعيفة (Thin). لم يتم تأكيد خطة الغرسة (Implant plan). لم يكمل المريض فحوصات الجاهزية. كان قسم التعقيم (CSSD) مضغوطاً بالفعل بالحالات المجدولة. وكانت وحدة الإفاقة (PACU) ممتلئة.</p>
    <p><span class="english-term">A case was added at noon—“should be quick.” The booking note was thin. No implant plan confirmed. The patient had not completed readiness checks. CSSD was already backed up with elective cases. PACU was full.</span></p>

    <p>لكن الجراح كان لديه نافذة زمنية، وكان النظام يخشى قول "لا". لذلك، تحركت الآلة. تم إرسال المريض. طُلب من الممرضات "الإسراع في تجهيز الغرفة". وتم اختصار التبديل (Turnover). وتم تجاوز المهلة (Time-out) بالكاد.</p>
    <p><span class="english-term">But the surgeon had a window, and the system was afraid to say no. So, the machine moved. The patient was sent for. Nurses were told to “rush the room.” Turnover was short-cut. The Time-out was barely a whisper.</span></p>

    <div class="alert-box">
        <p>بدأت الحالة واستمرت لثلاث ساعات بدلاً من ساعة واحدة. لم تكن الأداة الصحيحة متوفرة، مما أدى إلى ارتباك داخل العملية. تعين على الموظفين البقاء لوقت إضافي، وهم متعبون ومحبطون. وبسبب تأخر هذه الحالة، تعين إلغاء حالة روتينية أُخرى بعد أن كان المريض صائماً طوال اليوم.</p>
        <p><span class="english-term">The case started and took three hours instead of one. The correct instrument was not available, leading to intra-op scrambling. Staff had to stay on overtime, tired and frustrated. Because this case ran late, a routine elective case had to be cancelled after the patient had fasted all day.</span></p>
    </div>

    <div class="success-box">
        <p>لم يُصب أحد بضرر دائم، لكن <strong>النظام نفسه تعرض للضرر</strong>. أجبر الجدول الزمني الفريق على الاختيار بين السرعة والسلامة. هذا هو الخطر الأساسي لضعف الحوكمة التشغيلية: <strong>عندما تكذب الجدولة، تدفع السلامة الثمن.</strong> (IHI; AHRQ)</p>
        <p><span class="english-term">No one was permanently harmed, but <strong>the system itself took damage</strong>. The schedule forced the team to choose between speed and safety. This is the core danger of poor operational governance: <strong>when scheduling lies, safety pays the price.</strong> (IHI; AHRQ)</span></p>
    </div>

    <h2>23.1 المنطق السليم لسلامة الجدولة (لماذا هي ليست مسألة إدارية)</h2>
    <h3>23.1 The Safety Logic of Scheduling (Why It Is Not Administrative)</h3>

    <h3>23.1.1 الجدولة هي صانع إيقاع غرفة العمليات / Scheduling is the pacemaker</h3>
    <p>الجدول الزمني يملي وتيرة عمل كل شخص. إذا تم حجز ثلاث ساعات من العمل في فترة زمنية مدتها ساعتان، فإن النظام يعوض ذلك من خلال <strong>السرعة (Speed)</strong>. السرعة تقتل الـ Time-out، والسرعة تدمر التنظيف، والسرعة تُسكت التحدث بصوت عالٍ (Speaking up). (IHI; WHO SSC concepts)</p>
    <p><span class="english-term"><strong>23.1.1 Scheduling is the pacemaker of the OR</strong><br>The schedule dictates the pace of everyone’s work. If three hours of work are booked into a two-hour slot, the system compensates with <strong>speed</strong>. Speed kills the Time-out, speed ruins cleaning, and speed silences speaking up. (IHI; WHO SSC concepts)</span></p>

    <h3>23.1.2 "الجدولة الصادقة" كأداة للسلامة / Honest scheduling</h3>
    <p>تبني المستشفيات الآمنة الجداول الزمنية على <strong>البيانات التاريخية الفعلية (Actual historical data)</strong> لكل جراح وإجراء، وليس على التوقعات المتفائلة للجراح. الجدول الزمني الذي يخطط لـ "أفضل سيناريو" هو جدول مهيأ للفشل. (IHI)</p>
    <p><span class="english-term"><strong>23.1.2 “Honest scheduling” as a safety tool</strong><br>Safe hospitals build schedules on <strong>actual historical data</strong> for that surgeon and procedure, not on the surgeon’s optimistic guess. A schedule that plans for the “best-case scenario” is a schedule built to fail. (IHI)</span></p>

    <h2>23.2 انضباط الحجز: الحد الأدنى للبيانات لفتح الباب</h2>
    <h3>23.2 Booking Discipline: The Minimum Dataset to Open the Door</h3>

    <h3>23.2.1 الحجز هو عقد / A booking is a contract</h3>
    <p>عندما يحجز الجراح حالة، فإنه يُفعل سلسلة التوريد، والتعقيم (CSSD)، والتخدير، والأسرة. إذا كان الحجز غامضاً، فإن كل فريق لاحق سيضطر للتخمين.</p>
    <p><span class="english-term"><strong>23.2.1 A booking is a contract</strong><br>When a surgeon books a case, they trigger supply chain, CSSD, anesthesia, and beds. If the booking is vague, every downstream team has to guess.</span></p>

    <h3>23.2.2 الحد الأدنى لمجموعة بيانات الحجز (MBD) / The Minimum Booking Dataset</h3>
    <p>يجب ألا يتم قبول الحجز في النظام المجدول (Elective) ما لم يكتمل:</p>
    <div class="concept-box">
        <ul>
            <li>اسم المريض والمُعرّفات.</li>
            <li>اسم الإجراء بلغة موحدة (Standardized language) (بدون اختصارات غامضة).</li>
            <li>الجهة/الموقع/المستوى (Laterality/site/level).</li>
            <li>توقع الغرسة (نعم/لا، الشركة الموردة، نوع الطقم). (AORN concepts)</li>
            <li>احتياجات المعدات الخاصة (ليزر، مجهر، طاولة كسور).</li>
            <li>متطلبات التخدير والوضعية.</li>
            <li>متطلبات أسرة العناية المركزة (ICU) أو الرعاية اللاحقة. (IHI)</li>
        </ul>
        <p><strong>قاعدة التوقف الإلزامي:</strong> البيانات المفقودة = لا يوجد حجز مؤكد.</p>
        <p><span class="english-term"><strong>Hard stop rule:</strong> Missing data = no confirmed booking.</span></p>
    </div>

    <h3>23.2.3 صدق المدة ووقت التبديل / Duration honesty and turnover</h3>
    <p>يجب أن يشمل وقت الحجز: وقت الشق الجراحي (Cut time) + التخدير والوضعية + <strong>وقت التبديل (Turnover time) الواقعي</strong> لتنظيف الغرفة وإعادة تجهيزها. عدم تخصيص وقت للتبديل هو السبب الرئيسي لتعفن العقامة (Asepsis decay). (IHI; AORN)</p>

    <h2>23.3 قواعد الأولوية لتخصيص المسرح الجراحي (إدارة النزاعات)</h2>
    <h3>23.3 Priority Rules for Theatre Allocation (Managing Conflict)</h3>

    <h3>23.3.1 لماذا تهم الفئات / Why categories matter</h3>
    <p>عندما يتنافس جراحان على غرفة الطوارئ (Trauma/Emergency OR)، كيف تقرر الممرضة المسؤولة (Charge nurse)؟ إذا لم تكن هناك قواعد مكتوبة، سيفوز الجراح الأعلى صوتاً. هذا غير آمن. (AHRQ)</p>
    <p><span class="english-term"><strong>23.3.1 Why categories matter</strong><br>When two surgeons compete for the emergency OR, how does the charge nurse decide? If there are no written rules, the loudest surgeon wins. This is unsafe. (AHRQ)</span></p>

    <h3>23.3.2 الفئات القياسية للفرز (Standard Triage Categories)</h3>
    <p>تستخدم غرف العمليات الآمنة تصنيفاً مشابهاً لهذا:</p>
    <ul>
        <li><strong>الفئة 1 (طارئ لإنقاذ الحياة/الطرف - Life/Limb Saving):</strong> فوراً. يتوقف كل شيء آخر.</li>
        <li><strong>الفئة 2 (عاجل - Urgent):</strong> في غضون ساعتين إلى 6 ساعات. (مثل: التهاب الزائدة الدودية، كسور مفتوحة).</li>
        <li><strong>الفئة 3 (شبه عاجل - Semi-urgent):</strong> في غضون 24 ساعة.</li>
        <li><strong>الفئة 4 (مجدول/اختياري - Elective):</strong> مجدول مسبقاً. (IHI concepts)</li>
    </ul>

    <h3>23.3.3 من يفصل في التعادل؟ / Who breaks the tie?</h3>
    <p>عندما تتصادم حالتان من الفئة 1، لا يجب أن تتخذ الممرضة المسؤولة القرار السريري. يجب أن يكون هناك مسار تصعيد واضح <strong>للقائد السريري (المدير الطبي لغرفة العمليات أو رئيس الجراحة)</strong> لاتخاذ قرارات التوزيع السريري. (IHI)</p>

    <h2>23.4 إدارة الحالات الإضافية (مُعطلات التدفق)</h2>
    <h3>23.4 Managing Add-on Cases (The Flow Disruptors)</h3>

    <h3>23.4.1 الإضافات هي أكبر اختبار للحوكمة</h3>
    <p>تتجاوز الحالة الإضافية (Add-on) بوابات الجاهزية المعتادة لعدة أيام. لذلك، تحمل الإضافات أعلى مخاطر: الغرسات المفقودة، المرضى غير المحسّنين، وتجاوزات الـ Time-out. (IHI)</p>
    <p><span class="english-term"><strong>23.4.1 Add-ons are the greatest test of governance</strong><br>An add-on bypasses the normal multi-day readiness gates. Therefore, add-ons carry the highest risk of: missing implants, unoptimized patients, and time-out overrides. (IHI)</span></p>

    <div class="alert-box">
        <h3>23.4.2 "بوابة الإضافة" / The Add-on Gate</h3>
        <p>لا يُلغي الاستعجال الحاجة إلى السلامة. لكي تتم إضافة حالة غير طارئة (Non-Level 1) إلى القائمة، يجب على الجراح وفريق العمليات تأكيد:</p>
        <ol>
            <li>المعدات/الغرسات موجودة ومعقمة. (AAMI ST79)</li>
            <li>المريض طبيًا جاهز لهذه النافذة الزمنية المحددة.</li>
            <li>تتوفر سعة لمرحلة ما بعد الجراحة (PACU/ICU).</li>
        </ol>
        <p>إذا كانت الإجابة "لا" على أي من هذه، فإن الحالة ليست جاهزة، بغض النظر عن مدى رغبة الجراح في إجرائها. (IHI)</p>
        <p><span class="english-term">Urgency does not cancel safety. For a non-Level 1 case to be added, the surgeon and OR team must confirm: 1. Equipment/implants are physically present and sterile. 2. Patient is medically cleared for this window. 3. Post-op capacity (PACU/ICU) exists. If any are "no," the case is not ready.</span></p>
    </div>

    <h2>23.5 مواءمة السعة (حماية النظام بهوامش أمان)</h2>
    <h3>23.5 Capacity Alignment (Buffering the System)</h3>

    <h3>23.5.1 الكفاءة بدون هوامش أمان هي هشاشة / Efficiency without buffers is fragility</h3>
    <p>إذا قمت بجدولة غرفة العمليات لتعمل بنسبة 100% من طاقتها طوال اليوم، فإن أي تأخير بسيط لمدة 10 دقائق (التخدير استغرق وقتاً أطول، التنظيف تطلب وقتاً إضافياً) سيؤدي إلى انهيار بقية اليوم. تتطلب الموثوقية هوامش أمان (Buffers) مُصممة (تخصيص بنسبة 80-85%). (IHI)</p>
    <p><span class="english-term"><strong>23.5.1 Efficiency without buffers is fragility</strong><br>If you schedule the OR to run at 100% capacity all day, a single 10-minute delay collapses the rest of the day. Reliability requires designed buffers (80-85% utilization target). (IHI)</span></p>

    <h3>23.5.2 الاختناقات خارج غرفة العمليات / Bottlenecks outside the OR</h3>
    <p>لا يمكنك جدولة غرفة العمليات بمعزل عن غيرها. المواءمة تعني التأكد من قدرة الأقسام الأخرى على مواكبة الوتيرة:</p>
    <ul>
        <li><strong>سعة CSSD:</strong> هل يمتلك قسم التعقيم الأدوات الكافية والموظفين لمعالجة أحمال اليوم دون اللجوء إلى التعقيم الفوري (IUSS) غير الآمن؟ (AAMI ST79)</li>
        <li><strong>سعة PACU (وحدة الإفاقة):</strong> إذا كانت وحدة الإفاقة ممتلئة ولا توجد أسرة في الجناح، يتم حجز مرضى غرفة العمليات على طاولة الجراحة (PACU hold)، مما يوقف التدفق ويُجهد موظفي غرفة العمليات. (IHI)</li>
    </ul>

    <h2>23.6 القصة الحقيقية 2: "القائمة المجدولة التي سحقت حالة الطوارئ"</h2>
    <h3>23.6 Real Story 2: “The elective list that crushed the emergency case”</h3>

    <div class="quote-box">
        <p><strong>المشهد:</strong> مستشفى يعمل بسعة 95% من غرف العمليات للعمليات المجدولة (Electives). وصلت حالة طارئة (انفجار زائدة دودية) في الساعة 1:00 ظهراً. كل غرفة عمليات كانت قيد الاستخدام. وكل حالة مجدولة كانت متأخرة عن وقتها. لم تكن أي غرفة قريبة من الانتهاء.</p>
        <p><span class="english-term"><strong>The scene:</strong> A hospital ran its ORs at 95% elective capacity. An emergency case (ruptured appendix) arrived at 1:00 p.m. Every OR was in use. Every elective case was running late. No room was close to finishing.</span></p>
        
        <p><strong>الخطر:</strong> انتظر المريض الطارئ في الألم وارتفاع مخاطر الإنتان (Sepsis) لمدة أربع ساعات حتى تم الانتهاء من جراحة تجميلية (Elective) روتينية. فاز الجدول الزمني المالي على الفرز السريري.</p>
        <p><span class="english-term"><strong>The danger:</strong> The emergency patient waited in pain and rising sepsis risk for four hours while a routine cosmetic surgery finished. Financial scheduling beat clinical triage.</span></p>
        
        <p><strong>الإصلاح:</strong> تدخلت القيادة. لم يعد يُسمح للمستشفى بحجز 100% من غرفه. تم الاحتفاظ بغرفة واحدة كـ "غرفة طوارئ" مخصصة، وأصبحت الحالات الطارئة تُلغي الحالات المجدولة عند الضرورة بناءً على سياسة صارمة. <strong>الاستعداد للطوارئ هو قرار جدولة.</strong> (IHI; AHRQ)</p>
        <p><span class="english-term"><strong>The fix:</strong> Leadership intervened. The hospital was no longer allowed to book 100% of its rooms. One room was protected as a dedicated trauma room, and emergency cases bumped electives based on a strict policy. <strong>Emergency preparedness is a scheduling decision.</strong> (IHI; AHRQ)</span></p>
    </div>

    <h2>23.7 أدوات عملية لسلامة الجدولة</h2>
    <h3>23.7 Practical Tools for Scheduling Safety</h3>

    <div class="success-box">
        <ul>
            <li><strong>23.7.1 الأداة 1 — قاعدة التوقف الإلزامي للحجز (Booking Hard Stop Rule):</strong><br>
            لا يتم تخصيص وقت لغرفة العمليات للمقترح الجراحي ما لم تكتمل متطلبات مجموعة البيانات الأساسية (MBD). يرفض مكتب الجدولة النماذج غير المكتملة. (IHI)</li>
            <br>
            <li><strong>23.7.2 الأداة 2 — مصفوفة فرز الحالات الإضافية (Add-on Triage Matrix):</strong><br>
            وثيقة من صفحة واحدة يستخدمها مدير غرفة العمليات: إذا كانت الحالة فئة 2 (عاجلة)، هل الأدوات موجودة في المبنى ومعقمة؟ إذا كانت الإجابة لا، يتم التصعيد للمدير الطبي.</li>
            <br>
            <li><strong>23.7.3 الأداة 3 — تدقيق دقة الجدولة (Scheduling Accuracy Audit):</strong><br>
            تتبع الوقت المجدول مقابل الوقت الفعلي (Cut-to-close) لكل جراح. إذا كان الجراح يقلل باستمرار من تقدير الوقت بأكثر من 20%، يتم تعديل أوقات حجزه المستقبلية برمجياً. (IHI)</li>
        </ul>
    </div>

    <h2>23.8 القياس (كيف تعرف أن التدفق آمن)</h2>
    <h3>23.8 Measurement (How to Know the Flow is Safe)</h3>

    <h3>23.8.1 المؤشرات الاستباقية / Leading indicators</h3>
    <ul>
        <li>حجم الحالات الإضافية كنسبة مئوية من إجمالي الحالات (الحجم الكبير يكسر الموثوقية). (IHI)</li>
        <li>النسبة المئوية للحجوزات التي تحتوي على أخطاء دقة الوقت (Over/Under booking &gt; 20%).</li>
        <li>معدل امتثال نماذج الحجز للحد الأدنى من البيانات (MBD).</li>
    </ul>

    <h3>23.8.2 المؤشرات المتأخرة / Lagging indicators</h3>
    <ul>
        <li>ساعات العمل الإضافي (Overtime) للموظفين (مؤشر قوي على إرهاق النظام).</li>
        <li>الإلغاءات في نفس اليوم بسبب التجاوزات الزمنية للحالات (Overruns). (IHI)</li>
    </ul>

    <h2>23.14 تأملات الكاتب بعد سنوات في المسرح الجراحي</h2>
    <h3>23.14 The Writer’s Reflection</h3>
    <p><em>ملاحظة: تم تخطي الترقيم من 23.8 إلى 23.14 التزاماً بالنص الأصلي.</em></p>

    <h3>23.14.1 غرفة العمليات الهادئة هي غرفة عمليات آمنة / A quiet OR is a safe OR</h3>
    <p>في الغرفة ذات الجدولة الجيدة، يمشي الناس ولا يركضون. هناك وقت لغسل الأيدي، والقيام بالمهلة (Time-out)، وتجفيف محلول التحضير. الجدولة الجيدة تشتري لغرفة العمليات أثمن أداة أمان على الإطلاق: <strong>الوقت.</strong></p>
    <p><span class="english-term"><strong>23.14.1 A quiet OR is a safe OR</strong><br>In a well-scheduled room, people walk, they don’t run. There is time to wash hands, do the Time-out, and let the prep dry. Good scheduling buys the OR its most precious safety tool: <strong>Time.</strong></span></p>

    <h3>23.14.2 عندما يكون النظام صادقاً، يكون الفريق هادئاً / When the system is honest, the team is calm</h3>
    <p>عندما تكون الجدولة صادقة وتتوافق مع السعة، تتوقف الفرق عن الركض. تصبح قوائم التحقق ذات معنى مرة أخرى. ويعود الهدوء إلى عمليات العد. يقل التعب. ويشعر المرضى بذلك.</p>
    <p><span class="english-term"><strong>23.14.2 When the system is honest, the team is calm</strong><br>When scheduling is honest and capacity aligned, teams stop sprinting. Checklists become meaningful again. Counts become calm again. Fatigue decreases. Patients feel it.</span></p>

    <h3>23.14.3 قاعدتي / My rule</h3>
    <p>إذا كان الجدول الزمني يتطلب بطولات (Heroics) لينجح، فهو جدول غير آمن—حتى لو بدا فعالاً على الورق. (IHI; AHRQ)</p>
    <p><span class="english-term"><strong>23.14.3 My rule</strong><br>If the schedule requires heroics to succeed, it is an unsafe schedule—even if it looks efficient on paper. (IHI; AHRQ)</span></p>

    <div class="divider">***</div>

    <h2>ما يجب أن تتذكره من هذا الفصل / What You Should Remember from This Chapter</h2>
    <div class="success-box">
        <p><span class="english-term">Key Memory Messages:</span></p>
        <ul>
            <li>الجدولة والحجز هما أنظمة سلامة: فهما يشكلان ضغط الوقت، والإرهاق، وعمليات التسليم، وجودة الحواجز. (AHRQ; IHI)<br>
            <span class="english-term">Scheduling and booking are safety systems: they shape time pressure, fatigue, handoffs, and barrier quality.</span></li>
            
            <li>يتطلب انضباط الحجز حداً أدنى من البيانات ومدة زمنية صادقة؛ البيانات المفقودة تتحول إلى إلغاءات والتفافات غير آمنة. (IHI)<br>
            <span class="english-term">Booking discipline requires a minimum dataset and honest duration; missing data becomes cancellations and unsafe workarounds.</span></li>
            
            <li>يجب أن تجتاز الحالات الإضافية بوابات الجاهزية؛ الاستعجال لا يلغي حواجز السلامة. (WHO SSC concepts; IHI)<br>
            <span class="english-term">Add-ons must pass readiness gates; urgency does not cancel safety barriers.</span></li>
            
            <li>يجب أن تشمل مواءمة السعة قسم CSSD، الإفاقة (PACU)، الأسرة، الموظفين، والمعدات—هوامش الأمان (Buffers) تحمي السلامة. (IHI; AHRQ)<br>
            <span class="english-term">Capacity alignment must include CSSD, PACU, beds, staffing, and equipment—buffers protect safety.</span></li>
        </ul>
    </div>

    <div class="references-list">
        <h2>المراجع / References</h2>
        <ol>
            <li>Agency for Healthcare Research and Quality (AHRQ). Patient Safety resources (human factors, safety culture, systems under pressure, communication and handoffs).</li>
            <li>Institute for Healthcare Improvement (IHI). Reliability and quality improvement resources (flow, standard work, constraints, measurement, learning loops).</li>
            <li>World Health Organization (WHO). WHO Surgical Safety Checklist resources (team communication culture supporting safe starts and meaningful pauses).</li>
            <li>Association of periOperative Registered Nurses (AORN). Guidelines for Perioperative Practice (perioperative workflow concepts, equipment readiness, safety-related operational practices).</li>
            <li>Association for the Advancement of Medical Instrumentation (AAMI). ANSI/AAMI ST79 (concepts). Sterility assurance and processing constraints relevant to CSSD capacity alignment and IUSS pressure signals.</li>
        </ol>
    </div>

    <!-- Download Script -->
    <script>
    function downloadHTML() {
        var clone = document.documentElement.cloneNode(true);
        var btn = clone.querySelector('#downloadBar');
        if (btn) btn.remove();
        
        var body = clone.querySelector('body');
        if (body) body.style.paddingTop = '40px';

        var htmlContent = "<!DOCTYPE html>\n" + clone.outerHTML;
        var blob = new Blob([htmlContent], { type: "text/html;charset=utf-8" });
        var url = URL.createObjectURL(blob);
        var a = document.createElement("a");
        a.href = url;
        a.download = "الفصل_الثالث_والعشرون_الجدولة_والحجز.html";
        document.body.appendChild(a);
        a.click();
        
        setTimeout(function() {
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }, 100);
    }
    </script>

</body></html>